#!/bin/bash

# Задаем ключевое слово для поиска
keyword="ERROR"

# Проверка наличия аргумента командной строки (директории)
if [ -z "$1" ]; then
  echo "Пожалуйста, укажите директорию для поиска лог-файлов."
  exit 1
fi

# Директория для поиска лог-файлов передается в первом аргументе командной строки
log_directory="$1"

# Инициализация общего счетчика строк с ключевым словом
total_count=0

# Проверка существования директории
if [ ! -d "$log_directory" ]; then
  echo "Директория $log_directory не найдена."
  exit 1
fi

# Поиск всех файлов с расширением .log в указанной директории
for log_file in "$log_directory"/*.log; do
  # Проверка, что файл существует
  if [ -f "$log_file" ]; then
    # Подсчет количества строк с ключевым словом в текущем файле
    count=$(grep -c -i "$keyword" "$log_file")
    echo "Файл $log_file содержит $count строк с ключевым словом $keyword"
    
    # Обновление общего счетчика
    total_count=$((total_count + count))
  fi
done

# Вывод общего количества строк с ключевым словом по всем лог-файлам
echo "Общее количество строк с ключевым словом $keyword во всех лог-файлах: $total_count"
